(()=>{"use strict";function e(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function t(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r}var r,n,s,a;"function"==typeof SuppressedError&&SuppressedError;const i="__TAURI_TO_IPC_KEY__";class o{constructor(i){r.set(this,void 0),n.set(this,0),s.set(this,[]),a.set(this,void 0),t(this,r,i||(()=>{}),"f"),this.id=function(e,t=!1){return window.__TAURI_INTERNALS__.transformCallback(e,t)}((i=>{const o=i.index;if("end"in i)return void(o==e(this,n,"f")?this.cleanupCallback():t(this,a,o,"f"));const c=i.message;if(o==e(this,n,"f")){for(e(this,r,"f").call(this,c),t(this,n,e(this,n,"f")+1,"f");e(this,n,"f")in e(this,s,"f");){const a=e(this,s,"f")[e(this,n,"f")];e(this,r,"f").call(this,a),delete e(this,s,"f")[e(this,n,"f")],t(this,n,e(this,n,"f")+1,"f")}e(this,n,"f")===e(this,a,"f")&&this.cleanupCallback()}else e(this,s,"f")[o]=c}))}cleanupCallback(){Reflect.deleteProperty(window,`_${this.id}`)}set onmessage(e){t(this,r,e,"f")}get onmessage(){return e(this,r,"f")}[(r=new WeakMap,n=new WeakMap,s=new WeakMap,a=new WeakMap,i)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[i]()}}async function c(e,t={},r){return window.__TAURI_INTERNALS__.invoke(e,t,r)}new WeakMap;const d="Request cancelled";window.fetch=async function(e,t){const r=t?.signal;if(r?.aborted)throw new Error(d);const n=t?.maxRedirections,s=t?.connectTimeout,a=t?.proxy,i=t?.danger;t&&(delete t.maxRedirections,delete t.connectTimeout,delete t.proxy,delete t.danger);const h=t?.headers?t.headers instanceof Headers?t.headers:new Headers(t.headers):new Headers,f=new Request(e,t),l=await f.arrayBuffer(),u=0!==l.byteLength?Array.from(new Uint8Array(l)):null;for(const[e,t]of f.headers)h.get(e)||h.set(e,t);const w=(h instanceof Headers?Array.from(h.entries()):Array.isArray(h)?h:Object.entries(h)).map((([e,t])=>[e,"string"==typeof t?t:t.toString()]));if(r?.aborted)throw new Error(d);const p=await c("plugin:http|fetch",{clientConfig:{method:f.method,url:f.url,headers:w,data:u,maxRedirections:n,connectTimeout:s,proxy:a,danger:i}}),y=()=>c("plugin:http|fetch_cancel",{rid:p});if(r?.aborted)throw y(),new Error(d);r?.addEventListener("abort",(()=>{y()}));const{status:m,statusText:_,url:b,headers:g,rid:v}=await c("plugin:http|fetch_send",{rid:p}),T=new ReadableStream({start:e=>{const t=new o;t.onmessage=t=>{if(r?.aborted)return void e.error(d);const n=new Uint8Array(t),s=n[n.byteLength-1],a=n.slice(0,n.byteLength-1);1!=s?e.enqueue(a):e.close()},c("plugin:http|fetch_read_body",{rid:v,streamChannel:t}).catch((t=>{e.error(t)}))}}),E=new Response(T,{status:m,statusText:_});return Object.defineProperty(E,"url",{value:b}),Object.defineProperty(E,"headers",{value:new Headers(g)}),E}})();